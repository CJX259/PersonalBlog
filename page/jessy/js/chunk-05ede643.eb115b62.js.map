{"version":3,"sources":["webpack:///./src/components/Comments.vue?2752","webpack:///./src/components/Comments.vue?cc09","webpack:///src/components/Comments.vue","webpack:///./src/components/Comments.vue?6a40","webpack:///./src/components/Comments.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","_v","_s","commentsCount","_l","key","id","staticClass","user_name","parent","parent_name","_e","ctime","comments","on","$event","preventDefault","huifu","directives","name","rawName","value","expression","domProps","target","composing","email","comment","inputRandomCode","randomSvg","changeCode","sendComment","staticRenderFns","axios","commentList","rightCode","parentName","bid","methods","window","scrollTo","document","body","scrollHeight","url","method","then","resp","data","text","catch","e","console","log","toLowerCase","alert","getComments","initData","$route","query","path","getBid","count","watch","component"],"mappings":"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","file":"js/chunk-05ede643.eb115b62.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Comments.vue?vue&type=style&index=0&id=2a4505e7&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Comments.vue?vue&type=style&index=0&id=2a4505e7&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{attrs:{\"id\":\"blogComment\"}},[_c('span',[_vm._v(_vm._s(_vm.commentsCount)+\" Comments\")]),_c('ul',_vm._l((_vm.commentList),function(key){return _c('li',{key:key.id},[_c('span',{staticClass:\"user_name\"},[_vm._v(\" \"+_vm._s(key.user_name)+\": \"),(key.parent == 1)?_c('span',{staticClass:\"user_name\"},[_vm._v(\"@\"+_vm._s(key.parent_name))]):_vm._e()]),_c('span',{staticClass:\"date\"},[_vm._v(_vm._s(key.ctime))]),_c('p',[_vm._v(\" \"+_vm._s(key.comments)+\" \"),_c('span',{staticClass:\"res\",on:{\"click\":function($event){$event.preventDefault();return _vm.huifu(key.user_name)}}},[_vm._v(\"[回复]\")])])])}),0)]),_c('div',{staticClass:\"addComment\",attrs:{\"id\":\"addComment\"}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.name),expression:\"name\"}],attrs:{\"type\":\"text\",\"placeholder\":\"Nick Name\"},domProps:{\"value\":(_vm.name)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.name=$event.target.value}}}),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.email),expression:\"email\"}],attrs:{\"type\":\"text\",\"placeholder\":\"Email\"},domProps:{\"value\":(_vm.email)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.email=$event.target.value}}}),_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.comment),expression:\"comment\"}],attrs:{\"placeholder\":\"content\"},domProps:{\"value\":(_vm.comment)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.comment=$event.target.value}}}),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.inputRandomCode),expression:\"inputRandomCode\"}],attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.inputRandomCode)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.inputRandomCode=$event.target.value}}}),_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.randomSvg)},on:{\"click\":_vm.changeCode}}),_c('button',{on:{\"click\":_vm.sendComment}},[_vm._v(\"提交留言\")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div id=\"blogComment\">\r\n      <span>{{commentsCount}} Comments</span>\r\n      <ul>\r\n        <li v-for=\"(key) of commentList\" :key=\"key.id\">\r\n          <!-- 点击回复时把此评论的name传入，设置addComment的parentName -->\r\n          <span class=\"user_name\">\r\n            {{key.user_name}}:\r\n            <span v-if=\"key.parent == 1\" class=\"user_name\">@{{key.parent_name}}</span>\r\n          </span>\r\n          <span class=\"date\">{{key.ctime}}</span>\r\n          <p>\r\n            {{key.comments}}\r\n            <span class=\"res\" @click.prevent=\"huifu(key.user_name)\">[回复]</span>\r\n          </p>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n    <div class=\"addComment\" id=\"addComment\">\r\n      <!-- <input type=\"hidden\" v-model=\"commentId\"> -->\r\n      <input type=\"text\" placeholder=\"Nick Name\" v-model=\"name\" />\r\n      <input type=\"text\" placeholder=\"Email\" v-model=\"email\" />\r\n      <textarea placeholder=\"content\" v-model=\"comment\"></textarea>\r\n      <input type=\"text\" v-model=\"inputRandomCode\" />\r\n      <span v-html=\"randomSvg\" v-on:click=\"changeCode\"></span>\r\n      <button @click=\"sendComment\">提交留言</button>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nlet axios = require(\"axios\");\r\nexport default {\r\n  data() {\r\n    return {\r\n      commentList: [],\r\n      commentsCount: 0,\r\n      randomSvg: \"\",\r\n      rightCode: \"\",\r\n      // commentId: 0,\r\n      name: \"\",\r\n      email: \"\",\r\n      comment: \"\",\r\n      inputRandomCode: \"\",\r\n      parentName: \"0\",\r\n      parent: -1,\r\n      bid: null\r\n    };\r\n  },\r\n  methods: {\r\n    huifu(parentName) {\r\n      this.parent = 1;\r\n      this.parentName = parentName;\r\n      window.scrollTo(0, document.body.scrollHeight);\r\n      //   location.href = \"#addComment\";\r\n    },\r\n    changeCode() {\r\n      axios({\r\n        url: \"/getRandomCode\",\r\n        method: \"get\"\r\n      })\r\n        .then(resp => {\r\n          this.randomSvg = resp.data.data.data;\r\n          this.rightCode = resp.data.data.text;\r\n        })\r\n        .catch(e => {\r\n          console.log(e);\r\n        });\r\n    },\r\n    sendComment() {\r\n      if (\r\n        this.name == \"\" ||\r\n        this.email == \"\" ||\r\n        this.comment == \"\" ||\r\n        this.inputRandomCode == \"\"\r\n      ) {\r\n        alert(\"内容不能为空\");\r\n        return;\r\n      }\r\n      if (this.inputRandomCode.toLowerCase() != this.rightCode.toLowerCase()) {\r\n        alert(\"验证码错误\");\r\n        return;\r\n      }\r\n      // about的bid固定为-1\r\n\r\n      axios({\r\n        url:\r\n          \"/sendComment?bid=\" +\r\n          this.bid +\r\n          \"&parent=\" +\r\n          this.parent +\r\n          \"&name=\" +\r\n          this.name +\r\n          \"&email=\" +\r\n          this.email +\r\n          \"&comment=\" +\r\n          this.comment +\r\n          \"&parentName=\" +\r\n          this.parentName,\r\n        method: \"get\"\r\n      }).then(resp => {\r\n        alert(\"留言成功\");\r\n        // 此处想要触发vue重新渲染\r\n        this.getComments();\r\n        // location.reload();\r\n      });\r\n    },\r\n    initData() {\r\n      this.commentList = [];\r\n      this.commentsCount = 0;\r\n      this.randomSvg = \"\";\r\n      this.rightCode = \"\";\r\n      // commentId= 0;\r\n      this.name = \"\";\r\n      this.email = \"\";\r\n      this.comment = \"\";\r\n      this.inputRandomCode = \"\";\r\n      this.parentName = \"0\";\r\n      this.parent = -1;\r\n      this.bid = null;\r\n    },\r\n    getBid() {\r\n      // 每次get都需要把之前的内容清空\r\n      // this._data不可迭代，没办法,只能手动了\r\n      this.initData();\r\n      if (this.$route.query.bid) {\r\n        this.bid = this.$route.query.bid;\r\n      } else if (\r\n        this.$route.path == \"/about\" ||\r\n        this.$route.path == \"/guestbook\"\r\n      ) {\r\n        this.bid = -1;\r\n      }\r\n    },\r\n    getComments() {\r\n      this.getBid();\r\n      axios({\r\n        url: \"/getCommentsByBlogId?bid=\" + this.bid,\r\n        method: \"get\"\r\n      }).then(resp => {\r\n        this.commentList = resp.data.data;\r\n      });\r\n      axios({\r\n        url: \"/getCommentsCountByBlogId?bid=\" + this.bid,\r\n        method: \"get\"\r\n      }).then(resp => {\r\n        this.commentsCount = resp.data.data[0].count;\r\n      });\r\n      this.changeCode();\r\n    }\r\n  },\r\n  watch: {\r\n    $route: \"getComments\"\r\n  },\r\n  created() {\r\n    //！！！！！\r\n    //   此处拿bid需要修改\r\n    this.getComments();\r\n    // 拿comments\r\n  }\r\n};\r\n</script>\r\n<style scoped>\r\n#blogComment {\r\n  width: 100%;\r\n  margin: 20px 0px 0px 0px;\r\n  opacity: 0.9;\r\n  background: #fff;\r\n  box-shadow: 4px 4px 4px;\r\n  padding: 20px 10px 20px 10px;\r\n  box-sizing: border-box;\r\n  border-radius: 8px;\r\n}\r\n\r\n#blogComment ul {\r\n  width: 98%;\r\n}\r\n\r\n#blogComment .user_name {\r\n  font-weight: 600;\r\n}\r\n\r\n#blogComment .date {\r\n  float: right;\r\n  margin-right: 10px;\r\n}\r\n#blogComment .res {\r\n  font-weight: 600;\r\n  float: right;\r\n  margin-right: 10px;\r\n  color: #008c8c;\r\n  cursor: pointer;\r\n}\r\n#blogComment ul li {\r\n  list-style: none;\r\n  background: #d9edf7;\r\n  border: 1px dashed #7ca4c1;\r\n  margin: 10px 0px 0px 0px;\r\n  padding: 10px 0px 10px 10px;\r\n  border-radius: 5px;\r\n}\r\n\r\n#blogComment ul li span {\r\n  /* background: pink; */\r\n  padding: 5px 0px 5px 10px;\r\n}\r\n\r\n#blogComment ul li p {\r\n  margin: 20px 0px 0px 10px;\r\n}\r\n\r\n.addComment {\r\n  margin-top: 20px;\r\n  box-shadow: 4px 4px 4px;\r\n  width: 100%;\r\n  border: 1px solid grey;\r\n  background: #fff;\r\n  opacity: 0.9;\r\n  border-radius: 8px;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.addComment input {\r\n  width: 300px;\r\n  height: 30px;\r\n  border-radius: 5px;\r\n  margin: 15px 0px 5px 10px;\r\n  outline: none;\r\n  padding-left: 5px;\r\n}\r\n\r\n.addComment textarea {\r\n  width: 620px;\r\n  height: 100px;\r\n  margin: 5px 0px 5px 10px;\r\n  font-size: 16px;\r\n  padding: 5px 5px 5px 5px;\r\n  resize: none;\r\n}\r\n\r\n.addComment button {\r\n  display: block;\r\n  width: 100px;\r\n  background: white;\r\n  margin: 5px 0px 10px 10px;\r\n  height: 30px;\r\n  cursor: pointer;\r\n  border: 1px solid grey;\r\n  border-radius: 4px;\r\n}\r\n\r\n#addComment > span {\r\n  cursor: pointer;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Comments.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Comments.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Comments.vue?vue&type=template&id=2a4505e7&scoped=true&\"\nimport script from \"./Comments.vue?vue&type=script&lang=js&\"\nexport * from \"./Comments.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Comments.vue?vue&type=style&index=0&id=2a4505e7&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2a4505e7\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}